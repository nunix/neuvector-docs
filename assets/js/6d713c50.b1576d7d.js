"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8932],{8621:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>d,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var o=s(74848),i=s(28453);const t={title:"Command Line",taxonomy:{category:"docs"},slug:"/tronubleshooting/cli"},a=void 0,l={id:"troubleshooting/cli/cli",title:"Command Line",description:"Using the NeuVector Command Line",source:"@site/versioned_docs/version-5.3/12.troubleshooting/02.cli/02.cli.md",sourceDirName:"12.troubleshooting/02.cli",slug:"/tronubleshooting/cli",permalink:"/tronubleshooting/cli",draft:!1,unlisted:!1,editUrl:"https://github.com/neuvector/docs/edit/main/versioned_docs/version-5.3/12.troubleshooting/02.cli/02.cli.md",tags:[],version:"5.3",sidebarPosition:2,frontMatter:{title:"Command Line",taxonomy:{category:"docs"},slug:"/tronubleshooting/cli"},sidebar:"tutorialSidebar",previous:{title:"Troubleshooting",permalink:"/troubleshooting/troubleshooting"},next:{title:"13. Special Use Cases With Allinone",permalink:"/special"}},r={},c=[{value:"Using the NeuVector Command Line",id:"using-the-neuvector-command-line",level:3},{value:"CLI Command Examples",id:"cli-command-examples",level:5},{value:"Command Line Reference &amp; Commands",id:"command-line-reference--commands",level:2},{value:"Login/Logout",id:"loginlogout",level:3},{value:"User",id:"user",level:3},{value:"Policy",id:"policy",level:3},{value:"Quarantine",id:"quarantine",level:3},{value:"System",id:"system",level:3},{value:"Vulnerability Scan",id:"vulnerability-scan",level:3},{value:"Show/Debug commands",id:"showdebug-commands",level:3},{value:"Export/Import",id:"exportimport",level:3},{value:"Packet Sniffer",id:"packet-sniffer",level:4}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h3,{id:"using-the-neuvector-command-line",children:"Using the NeuVector Command Line"}),"\n",(0,o.jsx)(n.p,{children:"The NeuVector solution supports a limited set of functions using the CLI. The CLI is supported through the Manager, which in turn uses a RestAPI to issue commands to the Controller. The Controller then manages the Enforcer(s) appropriately. A complete set of operations is supported through the REST API, which can be exposed directly from the Controller. You can access the NeuVector CLI by typing the cli command for the Manager or Allinone, for example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"kubectl exec -it neuvector-manager-pod-5bb76b6754-rlmnp -n neuvector -- cli \n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"docker exec -it allinone cli\n"})}),"\n",(0,o.jsx)(n.p,{children:"Where \u2018allinone\u2019 is the container name for the Controller. You may need to use the container ID for the name."}),"\n",(0,o.jsxs)(n.p,{children:["Although the CLI is available through the Manager, we recommend using the ",(0,o.jsx)(n.a,{href:"/automation/automation",children:"REST API"})," directly into the controller for querying and automation."]}),"\n",(0,o.jsx)(n.h5,{id:"cli-command-examples",children:"CLI Command Examples"}),"\n",(0,o.jsx)(n.p,{children:"Here are some of the most common CLI commands:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> login\n> logout\n"})}),"\n",(0,o.jsx)(n.p,{children:"Use the same user/password you use for the console."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show policy -h\nUsage: cli show policy [OPTIONS] COMMAND [ARGS]...\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> create policy rule -h\nUsage: cli create policy rule [OPTIONS] FROM TO\n> delete policy rule -h\nUsage: cli delete policy rule [OPTIONS] ID\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show log -h\nUsage: cli show log [OPTIONS] COMMAND [ARGS]...\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set system policy_mode -h\nUsage: cli set system policy_mode [OPTIONS] MODE\n\n  Set system policy mode.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nMODES:\n  learn=discover\n  evaluate=monitor\n  enforce=protect\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set controller <leader_controller_id> debug -c cpath\n  Turn on debug mode.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set controller <leader_controller_id> debug\n  Turn off debug mdoe.\n"})}),"\n",(0,o.jsx)(n.p,{children:"More CLI commands are listed below."}),"\n",(0,o.jsx)(n.h2,{id:"command-line-reference--commands",children:"Command Line Reference & Commands"}),"\n",(0,o.jsx)(n.h3,{id:"loginlogout",children:"Login/Logout"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> login -h\nUsage: cli login [OPTIONS]\n\n  Login and obtain an authentication token.\n\nOptions:\n  --username TEXT\n  --password TEXT\n  -h, --help       Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> logout -h\nUsage: cli logout [OPTIONS]\n\n  Clear local authentication credentials.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> exit -h\nUsage: cli exit [OPTIONS]\n\n  Exit CLI.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"user",children:"User"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> create user -h\nUsage: cli create user [OPTIONS] USERNAME ROLE\n\n  Create user.\n\nOptions:\n  --email TEXT\n  --locale TEXT\n  --password TEXT\n  --password2 TEXT\n  -h, --help        Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set user -h\nUsage: cli set user [OPTIONS] USERNAME COMMAND [ARGS]...\n\n  Set user configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  local   Set local user.\n  remote  Set remote user.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> unset user -h\nUsage: cli unset user [OPTIONS] USERNAME COMMAND [ARGS]...\n\n  Unset user configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  local   Unset local user.\n  remote  Unset remote user.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> delete user -h\nUsage: cli delete user [OPTIONS] USERNAME\n\n  Delete user.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"policy",children:"Policy"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> create group -h\nUsage: cli create group [OPTIONS] NAME\n\n  Create group.\n\n  For --lable, use format: key,value. If the option value starts with @, the\n  criterion matches string with substring 'value'.\n\nOptions:\n  --image TEXT        container image name.\n  --node TEXT         node name.\n  --container TEXT    container workload name.\n  --application TEXT  container application name.\n  --label TEXT        container label.\n  -h, --help          Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set group -h\nUsage: cli set group [OPTIONS] NAME\n\n  Set group configuration.\n\n  For --lable, use format: key,value. If the option value starts with @, the\n  criterion matches string with substring 'value'.\n\nOptions:\n  --image TEXT        container image name.\n  --node TEXT         node name.\n  --container TEXT    container workload name.\n  --application TEXT  container application name.\n  --label TEXT        container label.\n  -h, --help          Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> delete group -h\nUsage: cli delete group [OPTIONS] NAME\n\n  Delete group.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> create policy rule -h\nUsage: cli create policy rule [OPTIONS] FROM TO\n\n  Create and append policy rule, with unique rule id (< 10000).\n\nOptions:\n  --id INTEGER           Policy rule ID. (Optional)\n  --ports TEXT           Port list. eg: any or\n                         80,8080,8500-8508,tcp/443,tcp/3306-3307,udp/53\n  --applications TEXT    Application list. eg: http,kafka\n  --action [allow|deny]\n  --after INTEGER        Specify policy rule ID that the new rule is inserted\n                         after. Use 0 to insert to the first.\n  --comment TEXT\n  -h, --help             Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set policy rule -h\nUsage: cli set policy rule [OPTIONS] ID\n\n  Configure policy rule.\n\nOptions:\n  --from TEXT\n  --to TEXT\n  --ports TEXT           Port list. eg: any or\n                         80,8080,8500-8508,tcp/443,tcp/3306-3307,udp/53\n  --applications TEXT    Application list. eg: http,kafka\n  --action [allow|deny]\n  --after INTEGER        Specify policy rule ID that the new rule is inserted\n                         after. Use 0 to insert to the first.\n  --comment TEXT\n  -h, --help             Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> delete policy rule -h\nUsage: cli delete policy rule [OPTIONS] ID\n\n  Delete policy rule.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show service -h\nUsage: cli show service [OPTIONS] COMMAND [ARGS]...\n\n  Show service\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  detail  Show service detail.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set service -h\nUsage: cli set service [OPTIONS] NAME COMMAND [ARGS]...\n\n  Set service configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  policy_mode  Set service policy mode [discover, monitor, protect]\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set system new_service policy_mode -h\nSEE System (below)\n"})}),"\n",(0,o.jsx)(n.h3,{id:"quarantine",children:"Quarantine"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set container\nUsage: cli set container [OPTIONS] ID_OR_NAME COMMAND [ARGS]...\n\n  Set container configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  quarantine  Set container quarantine state.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"system",children:"System"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set system -h\nUsage: cli set system [OPTIONS] COMMAND [ARGS]...\n\n  Set system configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  new_service policy_mode    Set system policy mode.\n  syslog  \t              Set syslog server IP and port (1.2.3.4:514)\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set system syslog -h\nUsage: cli set system syslog [OPTIONS] COMMAND [ARGS]...\n\n  Set syslog settings\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  category  syslog categories...\n  level     Set syslog level\n  server    Set syslog server IP and port (1.2.3.4:514)\n  status    Enable/disable syslog\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set system new_service policy_mode -h\nUsage: cli set system new_service policy_mode [OPTIONS] MODE\n\n  Set system new service policy mode.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nMODES:\n  discover\n  monitor\n  protect\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> unset system\nUsage: cli unset system [OPTIONS] COMMAND [ARGS]...\n\n  Unset system configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  syslog_server  Unset syslog server address.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"vulnerability-scan",children:"Vulnerability Scan"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set scan auto -h\nUsage: cli set scan auto [OPTIONS] AUTO\n\n  Set scanner mode.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nAUTO:\n  enable\n  disable\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> request scan container -h\nUsage: cli request scan container [OPTIONS] ID_OR_NAME\n\n  Request to scan one container\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> request scan node -h\nUsage: cli request scan node [OPTIONS] ID_OR_NAME\n\n  Request to scan one node\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show scan container -h\nUsage: cli show scan container [OPTIONS]\n\n  Show scan container summary\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  --node TEXT            list scan result on a given node\n  --first INTEGER        list the first n scan result, default is list all\n  -h, --help             Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show scan node -h\nUsage: cli show scan node [OPTIONS]\n\n  Show scan node summary\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  --first INTEGER        list the first n scan result, default is list all\n  -h, --help             Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show scan image -h\nUsage: cli show scan image [OPTIONS]\n\n  Show scan image summary\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  --first INTEGER        list the first n scan result, default is list all\n  -h, --help             Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show scan report container -h\nUsage: cli show scan report container [OPTIONS] ID_OR_NAME\n\n  Show scan container detail report\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show scan report image -h\nUsage: cli show scan report image [OPTIONS] NAME\n\n  Show scan image detail report\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show scan report node -h\nUsage: cli show scan report node [OPTIONS] ID_OR_NAME\n\n  Show scan node detail report\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"showdebug-commands",children:"Show/Debug commands"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show container -h\nUsage: cli show container [OPTIONS] COMMAND [ARGS]...\n\n  Show container.\n\nOptions:\n  -b, --brief            brief output\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  detail   Show container detail.\n  setting  show container configurations.\n  stats    Show container statistics.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show enforcer -h\nUsage: cli show enforcer [OPTIONS] COMMAND [ARGS]...\n\n  Show enforcer.\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  counter  Show enforcer counters.\n  detail   Show enforcer detail.\n  setting  show enforcer configurations.\n  stats    Show enforcer statistics.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show conversation -h\nUsage: cli show conversation [OPTIONS] COMMAND [ARGS]...\n\n  Show conversations.\n\nOptions:\n  -g, --group TEXT       filter conversations by group\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  pair  Show conversation detail between a pair of...\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show controller -h\nUsage: cli show controller [OPTIONS] COMMAND [ARGS]...\n\n  Show controller.\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  detail   Show controller detail.\n  setting  show controller configurations.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show group -h\nUsage: cli show group [OPTIONS] COMMAND [ARGS]...\n\n  Show group.\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  detail  Show group detail.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show log -h\nUsage: cli show log [OPTIONS] COMMAND [ARGS]...\n\n  Log operations.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  event      List events.\n  threat     List threats.\n  violation  List policy violations.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show node -h\nUsage: cli show node [OPTIONS] COMMAND [ARGS]...\n\n  Show node.\n\nOptions:\n  --sort TEXT            sort field.\n  --sort_dir [asc|desc]  sort direction.\n  -h, --help             Show this message and exit.\n\nCommands:\n  bench           Show node bench.\n  detail          Show node detail.\n  ip_2_container  Show node ip-container map.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show policy -h\nUsage: cli show policy [OPTIONS] COMMAND [ARGS]...\n\n  Show policy.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  derived  List derived policy rules\n  rule     Show policy rule.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show session -h\nUsage: cli show session [OPTIONS] COMMAND [ARGS]...\n\n  Show sessions.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  list     list session.\n  summary  show session summary.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show system -h\nUsage: cli show system [OPTIONS] COMMAND [ARGS]...\n\n  System operations.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  setting  Show system configuration.\n  summary  Show system summary.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> show user -h\nUsage: cli show user [OPTIONS] COMMAND [ARGS]...\n\n  Show user.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> set enforcer -h\nUsage: cli set enforcer [OPTIONS] ID_OR_NAME COMMAND [ARGS]...\n\n  Set enforcer configuration.\n\nOptions:\n  -h, --help  Show this message and exit.\n\nCommands:\n  debug  Configure enforcer debug.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> delete conversation pair -h\nUsage: cli delete conversation pair [OPTIONS] CLIENT SERVER\n\n  Delete conversations between a pair of containers.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> delete session -h\nUsage: cli delete session [OPTIONS]\n\n  clear session.\n\nOptions:\n  -e, --enforcer TEXT  filter sessions by enforcer\n  --id TEXT            filter sessions by session id\n  -h, --help           Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"exportimport",children:"Export/Import"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> request export config -h\nUsage: cli request export config [OPTIONS]\n\n  Export system configurations.\n\nOptions:\n  -s, --section [user|policy]\n  -f, --filename PATH\n  -h, --help                   Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"> request import config -h\nUsage: cli request import config [OPTIONS] FILENAME\n\n  Import system configurations.\n\nOptions:\n  -h, --help  Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.h4,{id:"packet-sniffer",children:"Packet Sniffer"}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"Sniffer files are stored in the /var/neuvector/pcap directory in the Enforcer container. Make sure you map the volume to your guest machine directory or local system directory to be able to access the files. For example in the docker-compose file add \u2018- /var/neuvector:/var/neuvector\u2019 in volumes."})}),"\n",(0,o.jsxs)(n.p,{children:["To start packet capture on a pod, you will need to know the containerID to pass into the ID_OR_NAME field. You can do this with ",(0,o.jsx)(n.code,{children:"show container -c <container_name>"}),". then start the sniffer with ",(0,o.jsx)(n.code,{children:"request sniffer start <container_id>"}),". For example,"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"admin#neuvector-svc-controller.neuvector> show container -c pos-test\n+--------------+-----------------------------------------------------------------------+-------------+---------------------------------------+----------+--------------+----------------------+------------------------+\n| id           | name                                                                  | host_name   | image                                 | state    | applications | started_at           | interfaces             |\n+--------------+-----------------------------------------------------------------------+-------------+---------------------------------------+----------+--------------+----------------------+------------------------+\n| fc0b5458db1a | k8s_POD_pos-test_pos-test_bd3e2c9d-847a-4bcd-ac76-cb6fa651a8d2_0      | gtk8s-node2 | k8s.gcr.io/pause:3.2                  | discover | []           | 2021-09-24T15:36:05Z | eth0:192.168.128.22/32 |\n| 0f48441a21cd | k8s_POD_pos-test_pos-test_c405efe5-f767-4fbf-b424-ea3106d9ec62_0      | gtk8s-node1 | k8s.gcr.io/pause:3.2                  | exit     | []           | 2021-09-23T23:53:56Z | {}                     |\n| 8ddb6052f2d1 | k8s_pos-test_pos-test_pos-test_bd3e2c9d-847a-4bcd-ac76-cb6fa651a8d2_0 | gtk8s-node2 | docker.io/garricktam/jmeter-pos:5.4.1 | discover | []           | 2021-09-24T15:36:40Z | eth0:192.168.128.22/32 |\n+--------------+-----------------------------------------------------------------------+-------------+---------------------------------------+----------+--------------+----------------------+------------------------+\n\n\nadmin#neuvector-svc-controller.neuvector> request sniffer start 8ddb6052f2d1\nadmin#neuvector-svc-controller.neuvector> show sniffer -c 8ddb6052f2d1\nTotal sniffers: 2\n+--------------------------------------------------------------------------+---------+--------------+--------------+------+-------------+\n| id                                                                       | status  | enforcer_id  | container_id | size | file_number |\n+--------------------------------------------------------------------------+---------+--------------+--------------+------+-------------+\n| 01119c164ab9cc73178f217ab7a6dc25075a6fe5869ab836eda172925fe7b068cd573030 | stopped | 4ab9cc73178f | 8ddb6052f2d1 |   24 |           1 |\n| 1f0702444ab9cc73178f217ab7a6dc25075a6fe5869ab836eda172925fe7b068cd573030 | running | 4ab9cc73178f | 8ddb6052f2d1 |   24 |           1 |\n+--------------------------------------------------------------------------+---------+--------------+--------------+------+-------------+\n\n\nadmin#neuvector-svc-controller.neuvector> request sniffer stop 1f0702444ab9cc73178f217ab7a6dc25075a6fe5869ab836eda172925fe7b068cd573030\nadmin#neuvector-svc-controller.neuvector> show sniffer -c 8ddb6052f2d1\nTotal sniffers: 2\n+--------------------------------------------------------------------------+---------+--------------+--------------+-------+-------------+\n| id                                                                       | status  | enforcer_id  | container_id |  size | file_number |\n+--------------------------------------------------------------------------+---------+--------------+--------------+-------+-------------+\n| 01119c164ab9cc73178f217ab7a6dc25075a6fe5869ab836eda172925fe7b068cd573030 | stopped | 4ab9cc73178f | 8ddb6052f2d1 |    24 |           1 |\n| 1f0702444ab9cc73178f217ab7a6dc25075a6fe5869ab836eda172925fe7b068cd573030 | stopped | 4ab9cc73178f | 8ddb6052f2d1 | 20165 |           1 |\n+--------------------------------------------------------------------------+---------+--------------+--------------+-------+-------------+\n"})}),"\n",(0,o.jsx)(n.admonition,{title:"important",type:"warning",children:(0,o.jsxs)(n.p,{children:["If the duration is not set, you will need to find the sniffer ID in order to stop the sniffer.  To do this, ",(0,o.jsx)(n.code,{children:"show sniffer -c <containerID>"}),".  Follow by ",(0,o.jsx)(n.code,{children:"request sniffer stop <sniffer_ID>"}),"."]})}),"\n",(0,o.jsx)(n.p,{children:"Command options:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"request sniffer start -h\nUsage: cli request sniffer start [OPTIONS]\n\n  Start sniffer.\n\nOptions:\n  -e, --enforcer TEXT        Add sniffer by enforcer\n  -c, --container TEXT       Add sniffer by container\n  -f, --file_number INTEGER  Maximum number of rotation files\n  -s, --file_size INTEGER    Maximum size (in MB) of rotation files\n  -o, --options TEXT         Sniffer filter\n  -h, --help                 Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"show sniffer -h\nUsage: cli show sniffer [OPTIONS] COMMAND [ARGS]...\n\n  Show sniffer.\n\nOptions:\n  -e, --enforcer TEXT  Show sniffers by enforcer\n  -h, --help           Show this message and exit.\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"request sniffer stop -h\nUsage: cli request sniffer stop [OPTIONS] ID\n\n  Stop sniffer. You may need to include both the enforcer ID and the container ID.\n\nOptions:\n  -e, --enforcer TEXT  Delete sniffer by enforcer\n  -h, --help           Show this message and exit.\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var o=s(96540);const i={},t=o.createContext(i);function a(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);