<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-deploying/ecs/ecs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Amazon ECS | Neuvector Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://open-docs.neuvector.com/next/deploying/ecs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Amazon ECS | Neuvector Docs"><meta data-rh="true" name="description" content="Important: Deployment on Amazon ECS is No Longer Supported"><meta data-rh="true" property="og:description" content="Important: Deployment on Amazon ECS is No Longer Supported"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://open-docs.neuvector.com/next/deploying/ecs"><link data-rh="true" rel="alternate" href="https://open-docs.neuvector.com/next/deploying/ecs" hreflang="en"><link data-rh="true" rel="alternate" href="https://open-docs.neuvector.com/next/deploying/ecs" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c7e9e479.css">
<script src="/assets/js/runtime~main.a15c0365.js" defer="defer"></script>
<script src="/assets/js/main.af7f0a06.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Neuvector Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-dark.svg" alt="Neuvector Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/next/">Next 🚧</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/next/deploying/ecs">Next 🚧</a></li><li><a class="dropdown__link" href="/deploying/ecs">5.3</a></li><li><a class="dropdown__link" href="/5.2/deploying/ecs">5.2</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://neuvector.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Neuvector Home<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/neuvector/neuvector/" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/neuvector/docs/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://hub.docker.com/u/neuvector" target="_blank" rel="noopener noreferrer" class="dropdown__link">NeuVector images on Docker Hub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More From SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="http://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester</a></li><li><a href="http://fleet.rancher.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet</a></li><li><a href="http://kubewarden.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__kubewarden">Kubewarden</a></li><li><a href="https://rancherdesktop.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rd">Rancher Desktop</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/">1. Basics</a><button aria-label="Expand sidebar category &#x27;1. Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/next/deploying">2. Deploying NeuVector 5.x</a><button aria-label="Collapse sidebar category &#x27;2. Deploying NeuVector 5.x&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/next/deploying/production">Deploying NeuVector</a><button aria-label="Expand sidebar category &#x27;Deploying NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/rancher">Rancher Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/openshift">RedHat OpenShift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/docker">Docker &amp; Mirantis Kubernetes Engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/awsmarketplace">AWS Marketplace Billing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/azuremarketplace">Azure Marketplace Billing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/publick8s">Public Cloud K8s AKS, EKS, GKE, IBM...</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/airgap">Air Gapping NeuVector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/next/deploying/ecs">Amazon ECS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/remove">Removing or Resetting NeuVector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/deploying/restore">Restoring NeuVector Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/configuration">3. Initial Configuration &amp; Console Login</a><button aria-label="Expand sidebar category &#x27;3. Initial Configuration &amp; Console Login&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/navigation">4. Navigating NeuVector</a><button aria-label="Expand sidebar category &#x27;4. Navigating NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/policy">5. Security Policy</a><button aria-label="Expand sidebar category &#x27;5. Security Policy&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/scanning">6. Security Risks, Scanning &amp; Compliance</a><button aria-label="Expand sidebar category &#x27;6. Security Risks, Scanning &amp; Compliance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/reporting">7. Reporting</a><button aria-label="Expand sidebar category &#x27;7. Reporting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/integration">8. Enterprise Integration</a><button aria-label="Expand sidebar category &#x27;8. Enterprise Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/testing">9. Testing NeuVector</a><button aria-label="Expand sidebar category &#x27;9. Testing NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/updating">10. Updating NeuVector</a><button aria-label="Expand sidebar category &#x27;10. Updating NeuVector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/automation">11. Workflow &amp; Automation</a><button aria-label="Expand sidebar category &#x27;11. Workflow &amp; Automation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/troubleshooting">12. Troubleshooting</a><button aria-label="Expand sidebar category &#x27;12. Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/special">13. Special Use Cases With Allinone</a><button aria-label="Expand sidebar category &#x27;13. Special Use Cases With Allinone&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/next/releasenotes">14. Release Notes</a><button aria-label="Expand sidebar category &#x27;14. Release Notes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Neuvector Docs<!-- --> <b>Next 🚧</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/deploying/ecs">latest version</a></b> (<!-- -->5.3<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/next/deploying"><span itemprop="name">2. Deploying NeuVector 5.x</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Amazon ECS</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next 🚧</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Amazon ECS</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="important-deployment-on-amazon-ecs-is-no-longer-supported">Important: Deployment on Amazon ECS is No Longer Supported<a href="#important-deployment-on-amazon-ecs-is-no-longer-supported" class="hash-link" aria-label="Direct link to Important: Deployment on Amazon ECS is No Longer Supported" title="Direct link to Important: Deployment on Amazon ECS is No Longer Supported">​</a></h3>
<p>The reference section below is not being maintained. However, it may provide some assistance in understanding how to deploy the Allinone on ECS.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-on-aws-using-ecs">Deploy on AWS Using ECS<a href="#deploy-on-aws-using-ecs" class="hash-link" aria-label="Direct link to Deploy on AWS Using ECS" title="Direct link to Deploy on AWS Using ECS">​</a></h3>
<p>This is an example of how to deploy NeuVector using ECS.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Please see the Kubernetes examples for EKS.</p></div></div>
<ol>
<li>
<p>Prepare several Amazon ECS instances which have the Docker engine and ECS agent containers built-in. Pick one node for the management console. Then define Security Group rules that allow inbound TCP port 8443 (NeuVector’s default management console port) for access by your client browser.</p>
</li>
<li>
<p>Define a Security Group that allows TCP and UDP ports on 18300, 18301, 18400, 18401 . This is used by NeuVector enforcers to talk to the Controllers/Allinone. Apply this Security Group to all the ECS instances that will be deploying the NeuVector enforcers and controllers/allinone.</p>
</li>
<li>
<p>Set an attribute on the nodes that you want to deploy NeuVector allinone or controller container. For example, if you want to run NeuVector in a controller HA mode, the recommendation is to pick at least 3 nodes then add the attribute to all of the 3 nodes.</p>
</li>
</ol>
<p>This is how to add attributes to your ECS instances:</p>
<p>Select the instance, then pick “View/Edit Attributes” from the Actions drop down menu.</p>
<p><img decoding="async" loading="lazy" alt="Attributes" src="/assets/images/1viewattributes-b5598a7529adcc84eceadc4f85e44841.png" width="967" height="469" class="img_CujE"></p>
<p>Then add a new attribute. For example “allinone-node” with value “true”.</p>
<p><img decoding="async" loading="lazy" alt="AddAttributes" src="/assets/images/2addattribute-1e1c2fdf070cad1468496da1a89da615.png" width="975" height="236" class="img_CujE"></p>
<ol start="4">
<li>Create the Allinone Task Definition. Create a new Task Definition for the Allinone container. You can use the ECS interface to manually create it or paste in the sample JSON file (see below for samples). Refer to section “1. Deploying NeuVector” of these docs for how to configure the Allinone.</li>
</ol>
<p>Enter the placement constraint. For example, if you used the attribute labeling above, then enter this in the constraint.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">attribute:allinone-node=~true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="AllinoneTask" src="/assets/images/3taskdef-96cc0282b1e05656aa141d571e56f7f5.png" width="961" height="551" class="img_CujE"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If you examine the updated JSON file now you’ll see the placement constraint added to it.</p></div></div>
<ol start="5">
<li>Create a new service for the Allinone task. Set the “Placement Templates” to “One Task Per Host” so that only one Allinone/Controller can run on any host. You will also see the constraint will be used “memberOf(attribute<!-- -->:allinone-node<!-- -->=~true) which requires the node to have that attribute.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="AllinonePlace" src="/assets/images/3taskplacement-12069402fc5d564715a830cc69c7cbf3.png" width="975" height="181" class="img_CujE"></p>
<ol start="6">
<li>
<p>Now you can deploy the Allinone service. Set the “Number of tasks” to the desired Allinone/Controller number. Now the NeuVector Allinone or Controller containers will start running on the nodes selected. After the Allinone starts running you should be able to connect to the NeuVector console through HTTPS on port 8443.</p>
</li>
<li>
<p>Create the Enforcer Task Definition. This is similar to the Allinone task. Configure manually through the ECS console or use the JSON sample below.</p>
</li>
</ol>
<p>For the Enforcer placement constraint you will require that the Enforcer must NOT be on the same node as the allinone.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">attribute:allinone-node!~true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="EnforcerTask" src="/assets/images/4enforcertask-8eeaf3ba102dac254e419859f7687548.png" width="975" height="321" class="img_CujE"></p>
<ol start="8">
<li>Create a new service for the Enforcer task. Again, set the Task Placement to “One Task Per Host” so only one Enforcer is deployed on each host. Also note the additional constraint should show that it prevents deployment on an allinone node.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="EnforcerPlacement" src="/assets/images/5taskplacement-712dc25c19faa8aeb44c686a67356a2e.png" width="975" height="246" class="img_CujE"></p>
<p>Deploy this service with desired number of enforcer nodes in “Number of tasks”. Very shortly all the enforcers will be up and running. From the NeuVector console you will be able to see all nodes being detected with enforcers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sample-ecs-json-task-definitions">Sample ECS JSON Task Definitions<a href="#sample-ecs-json-task-definitions" class="hash-link" aria-label="Direct link to Sample ECS JSON Task Definitions" title="Direct link to Sample ECS JSON Task Definitions">​</a></h3>
<p>You can use the following samples as starting points for configuring the task definitions for the NeuVector containers.</p>
<p>Create a new task definition, then click Configure Via JSON at bottom. Before pasting in the json below, replace the IP address and image path (find REPLACE in samples). Typically, the IP address would be the Private IP address of the AWS Instance where the allinone will run. You can also specific a different family name than my-allinone/my-enforcer (at the bottom of json).</p>
<p>Sample Allinone json file:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;networkMode&quot;: &quot;bridge&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;taskRoleArn&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;pidMode&quot;: &quot;host&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;containerDefinitions&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;volumesFrom&quot;: [],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;memory&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;extraHosts&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dnsServers&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;disableNetworking&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dnsSearchDomains&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;portMappings&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18400,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18400,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18401,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18401,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;udp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 8443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 8443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 1443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 10443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;hostname&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;essential&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;entryPoint&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;mountPoints&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/lib/modules&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;modules&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/var/run/docker.sock&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;dockersock&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/host/proc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;proc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/host/cgroup&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;cgroup&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;allinone&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ulimits&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dockerSecurityOptions&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;environment&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;name&quot;: &quot;CLUSTER_JOIN_ADDR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;value&quot;: &quot;REPLACE: Private IP&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;links&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;workingDirectory&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;readonlyRootFilesystem&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;image&quot;: &quot;REPLACE: Image Path/Name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;command&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;user&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dockerLabels&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;com.myself.name&quot;: &quot;neuvector&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;logConfiguration&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;cpu&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;privileged&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;memoryReservation&quot;: 768</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;volumes&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/lib/modules&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;modules&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/var/run/docker.sock&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;dockersock&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/proc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;proc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/sys/fs/cgroup&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;cgroup&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;family&quot;: &quot;my-allinone&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;placementConstraints&quot;: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Sample Enforcer json file:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;networkMode&quot;: &quot;bridge&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;taskRoleArn&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;pidMode&quot;: &quot;host&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;containerDefinitions&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;volumesFrom&quot;: [],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;memory&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;extraHosts&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dnsServers&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;disableNetworking&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dnsSearchDomains&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;portMappings&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18401,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18401,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;tcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;hostPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPort&quot;: 18301,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;protocol&quot;: &quot;udp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;hostname&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;essential&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;entryPoint&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;mountPoints&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/lib/modules&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;modules&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/var/run/docker.sock&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;dockersock&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/host/proc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;proc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;containerPath&quot;: &quot;/host/cgroup&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;sourceVolume&quot;: &quot;cgroup&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;readOnly&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;enforcer&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ulimits&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dockerSecurityOptions&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;environment&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;name&quot;: &quot;CLUSTER_JOIN_ADDR&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;value&quot;: &quot;REPLACE: Private IP&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;links&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;workingDirectory&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;readonlyRootFilesystem&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;image&quot;: &quot;REPLACE: Image Path/Name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;command&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;user&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;dockerLabels&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;com.myself.name&quot;: &quot;neuvector&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;logConfiguration&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;cpu&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;privileged&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;memoryReservation&quot;: 512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;volumes&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/lib/modules&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;modules&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/var/run/docker.sock&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;dockersock&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/proc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;proc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;host&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;sourcePath&quot;: &quot;/sys/fs/cgroup&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;cgroup&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;family&quot;: &quot;my-enforcer&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;placementConstraints&quot;: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="live-updating-neuvector">Live Updating NeuVector<a href="#live-updating-neuvector" class="hash-link" aria-label="Direct link to Live Updating NeuVector" title="Direct link to Live Updating NeuVector">​</a></h3>
<p>You can do a live update of the NeuVector containers in ECS without interrupting services. NeuVector’s services can be easily updated or upgraded without interrupting any running services. To do that in Amazon ECS:</p>
<ol>
<li>
<p>If you have multiple controllers or Allinones deployed as a cluster, ignore this step. If there is only a single Allinone/controller in the system, find a new ECS instance and deploy a 2nd Allinone/controller container on it (follow the NeuVector allinone/controller ECS deployment steps). After deployed, in the NeuVector management console, you will see this new controller up and running (under Resources &gt; Controllers). This is required so that all stateful data is replicated between controllers.</p>
</li>
<li>
<p>In ECS Services, reset and delete the old Allinone/controller service. Pull the updated NeuVector images manually or trigger AWS ECS to pull new versions of Allinone/controller containers from Dockerhub or your private registry.</p>
</li>
<li>
<p>Create a new revision of the Allinone/Controller task, update the “CLUSTER_JOIN_ADDR” to the 2nd Allinone/controller’s private node IP address.</p>
</li>
<li>
<p>Create a new service to deploy this new task (follow the same steps to deploy on ECS). After completed, the new version of the Allinone/controller should be up and running. From the NeuVector management console, all the logs and policies should still be there. Optionally, you can bring down the 2nd Allinone/Controller container now since there should be a Allinone/Controller now started on the original node.</p>
</li>
<li>
<p>From ECS Services, shutdown and update the Enforcers. Manually or auto-trigger the pulling of new Enforcer images. Then restart or update the Enforcer on all nodes. From the NeuVector console, you will see all Enforcers are up to date.</p>
</li>
<li>
<p>If you are using the separate Manager container instead of the Allinone (which already has the manager in it), simply shutdown and remove the old manager container. Then pull the new manager version, and deploy it, pointing the CLUSTER_JOIN_ADDR to the IP of the controller.</p>
</li>
</ol>
<p>All NeuVector containers are now updated live. All policies, logs, and configurations are unaffected. The live graph view will be regenerated automatically as soon as there is new live traffic flowing between containers.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/neuvector/docs/edit/main/docs/02.deploying/09.ecs/09.ecs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/next/deploying/airgap"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Air Gapping NeuVector</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/next/deploying/remove"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Removing or Resetting NeuVector</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#important-deployment-on-amazon-ecs-is-no-longer-supported" class="table-of-contents__link toc-highlight">Important: Deployment on Amazon ECS is No Longer Supported</a></li><li><a href="#deploy-on-aws-using-ecs" class="table-of-contents__link toc-highlight">Deploy on AWS Using ECS</a></li><li><a href="#sample-ecs-json-task-definitions" class="table-of-contents__link toc-highlight">Sample ECS JSON Task Definitions</a></li><li><a href="#live-updating-neuvector" class="table-of-contents__link toc-highlight">Live Updating NeuVector</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SUSE NeuVector. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>